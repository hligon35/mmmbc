<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Watch live services and recent videos from Mt. Moriah Missionary Baptist Church in Paducah, KY." />
    <meta name="referrer" content="strict-origin-when-cross-origin" />
    <link rel="icon" type="image/png" href="../Icons/favicon.png">
    <link rel="apple-touch-icon" href="../Icons/favicon.png">
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="../schedule_app.css">
    <title>Live Praise - Mt. Moriah Missionary Baptist Church</title>
</head>
<body>
    <nav class="top-nav">
        <div class="nav-left">
            <img src="../ConImg/MtMoriahLogo-1.png" alt="Mt. Moriah Logo" class="nav-logo">
            <a class="devicon-btn" href="../admin/" aria-label="Admin" title="Admin"><span class="devicon-btn__text">&lt;/&gt;</span></a>
        </div>
        <div class="nav-links" id="navLinks">
            <a href="../index.html">Home</a>
            <a href="ministries.html">Ministries</a>
            <a href="leadership.html">Leadership & Staff</a>
            <a href="church_history.html">Church History</a>
            <a href="facility_rental.html">Facility Rental</a>
            <a href="photo_gallery.html">Photo Gallery</a>
            <a href="live_praise.html">Live Praise</a>
            <a href="contact.html">Contact Us</a>
        </div>
        <button aria-label="Toggle navigation menu" aria-controls="navLinks" aria-expanded="false" class="menu-button" id="menuButton" title="Menu" type="button">
            <span></span>
            <span></span>
            <span></span>
            <span></span>
        </button>
    </nav>

    <main>
        <section class="content-section">
            <h1>Live Praise</h1>
            <p>When our services are being broadcast LIVE, the current service will be shown at the top of the page. </p>
            <p>Otherwise, the most recent service will appear at the top.</p>
            <p>Other past services are shown below the first image in chronological order.</p>

            <div class="youtube-live-placeholder" aria-label="YouTube live stream">
                <div class="youtube-live-placeholder__inner">
                    <div class="youtube-embed">
                        <iframe id="livePraiseTopPlayer" title="Mt. Moriah Missionary Baptist Church - Live Stream" loading="lazy" src="https://www.youtube.com/embed/live_stream?channel=UCkAaHiYmUKIdKePifg1D2pg&rel=0" referrerpolicy="strict-origin-when-cross-origin" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
                    </div>
                    <div style="margin-top: 10px;">
                        <a class="youtube-live-placeholder__button" id="livePraiseWatchLink" href="https://www.youtube.com/channel/UCkAaHiYmUKIdKePifg1D2pg/live" rel="noopener noreferrer" target="_blank">Watch on YouTube</a>
                    </div>
                    <!-- <p class="youtube-live-placeholder__text">Paste the YouTube Live embed URL into the iframe <strong>src</strong> to enable the live player.</p> -->
                </div>
            </div>

            <div class="youtube-section" aria-label="Recent YouTube videos">
                <h2 class="youtube-section__title">Recent Videos</h2>
                <p class="youtube-section__status" id="youtubeFeedStatus">Loading latest videosâ€¦</p>
                <p class="youtube-section__status" style="margin-top: -6px;"><a id="youtubeFeedLink" href="/public/youtube.json" rel="noopener noreferrer" target="_blank">Open the live feed JSON</a></p>
                <div class="youtube-grid" id="recentVideosGrid">
                    <div class="youtube-card">
                        <div class="youtube-embed">
                            <iframe title="Recent video 1" loading="lazy" src="https://www.youtube.com/embed/DI0RZZt0ju0?rel=0" referrerpolicy="strict-origin-when-cross-origin" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
                        </div>
                        <a class="youtube-card__link" href="https://www.youtube.com/watch?v=DI0RZZt0ju0" rel="noopener noreferrer" target="_blank">Watch on YouTube</a>
                    </div>
                    <div class="youtube-card">
                        <div class="youtube-embed">
                            <iframe title="Recent video 2" loading="lazy" src="https://www.youtube.com/embed/bNzPE9jPbcU?rel=0" referrerpolicy="strict-origin-when-cross-origin" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
                        </div>
                        <a class="youtube-card__link" href="https://www.youtube.com/watch?v=bNzPE9jPbcU" rel="noopener noreferrer" target="_blank">Watch on YouTube</a>
                    </div>
                    <div class="youtube-card">
                        <div class="youtube-embed">
                            <iframe title="Recent video 3" loading="lazy" src="https://www.youtube.com/embed/PhojfsrhtJA?rel=0" referrerpolicy="strict-origin-when-cross-origin" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
                        </div>
                        <a class="youtube-card__link" href="https://www.youtube.com/watch?v=PhojfsrhtJA" rel="noopener noreferrer" target="_blank">Watch on YouTube</a>
                    </div>
                    <div class="youtube-card">
                        <div class="youtube-embed">
                            <iframe title="Recent video 4" loading="lazy" src="https://www.youtube.com/embed/O39QmbszzxI?rel=0" referrerpolicy="strict-origin-when-cross-origin" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
                        </div>
                        <a class="youtube-card__link" href="https://www.youtube.com/watch?v=O39QmbszzxI" rel="noopener noreferrer" target="_blank">Watch on YouTube</a>
                    </div>
                    <div class="youtube-card">
                        <div class="youtube-embed">
                            <iframe title="Recent video 5" loading="lazy" src="https://www.youtube.com/embed/sq_bGsEiAO4?rel=0" referrerpolicy="strict-origin-when-cross-origin" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
                        </div>
                        <a class="youtube-card__link" href="https://www.youtube.com/watch?v=sq_bGsEiAO4" rel="noopener noreferrer" target="_blank">Watch on YouTube</a>
                    </div>
                    <div class="youtube-card">
                        <div class="youtube-embed">
                            <iframe title="Recent video 6" loading="lazy" src="https://www.youtube.com/embed/6VUHyYuI_xs?rel=0" referrerpolicy="strict-origin-when-cross-origin" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
                        </div>
                        <a class="youtube-card__link" href="https://www.youtube.com/watch?v=6VUHyYuI_xs" rel="noopener noreferrer" target="_blank">Watch on YouTube</a>
                    </div>
                </div>
                <div class="youtube-section__cta">
                    <a class="youtube-section__button" href="https://youtube.com/channel/UCkAaHiYmUKIdKePifg1D2pg" rel="noopener noreferrer" target="_blank">View All Videos on YouTube</a>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="footer-top-row">
            <img src="../ConImg/MtMoriahLogo-1.png" alt="Mt. Moriah Logo" class="footer-logo">
            <div class="footer-text-content">
                <p>Our doors are always open to you. If you are without a church home, we hope you will unite with the Mt. Moriah family. Wherever you go, may you always feel the presence of God and may the blessings of faithful worship bring peace and joy to your heart.</p>
            </div>
        </div>
        <div class="footer-bottom-row">
            <div class="footer-links-section" id="quick-links">
                <h4>Quick Links</h4>
                <ul>
                    <li><a href="../index.html"><img src="../Icons/home.png" alt="Home icon" class="link-icon"><span class="link-text">Home</span></a></li>
                    <li><a href="ministries.html"><img src="../Icons/ministries.png" alt="Ministries icon" class="link-icon"><span class="link-text">Ministries</span></a></li>
                    <li><a href="leadership.html"><img src="../Icons/leadership.png" alt="Leadership icon" class="link-icon"><span class="link-text">Leadership</span></a></li>
                    <li><a href="church_history.html"><img src="../Icons/churchhistory.png" alt="Church History icon" class="link-icon"><span class="link-text">Church History</span></a></li>
                    <li><a href="facility_rental.html"><img src="../Icons/facilityrental.png" alt="Facility Rental icon" class="link-icon"><span class="link-text">Facility Rental</span></a></li>
                    <li><a href="contact.html"><img src="../Icons/contactus.png" alt="Contact Us icon" class="link-icon"><span class="link-text">Contact Us</span></a></li>
                </ul>
            </div>
            <div class="footer-links-section" id="connect-us">
                <h4>Connect With Us</h4>
                <ul>
                    <li><a href="https://www.google.com/maps/search/?api=1&query=1201+South+8th+Street+Paducah+KY" target="_blank" rel="noopener noreferrer"><img src="../Icons/address.png" alt="Address icon" class="link-icon"><span class="link-text">1201 South 8th Street, Paducah, KY</span></a></li>
                    <li><a href="tel:2704433714"><img src="../Icons/phone.png" alt="Phone icon" class="link-icon"><span class="link-text">(270) 443-3714</span></a></li>
                    <li><a href="mailto:mtmoriahmbc1201@gmail.com"><img src="../Icons/mailus.png" alt="Email Us icon" class="link-icon"><span class="link-text">Email Us</span></a></li>
                    <li><a href="https://www.facebook.com/MtMoriahPaducah"><img src="../Icons/facebook.png" alt="Facebook icon" class="link-icon"><span class="link-text">Like us on Facebook</span></a></li>
                    <li><a href="https://youtube.com/channel/UCkAaHiYmUKIdKePifg1D2pg"><img src="../Icons/youtube.png" alt="YouTube icon" class="link-icon"><span class="link-text">Subscribe on YouTube</span></a></li>
                </ul>
            </div>
        </div>
        <div class="footer-copyright-row">
            <p>Designed by &copy; 2025 Iconiq Dreamscapes</p>
            <p>&copy; 2025 Mt. Moriah Missionary Baptist Church. All rights reserved.</p>
        </div>
    </footer>

        <script src="../script.js"></script>
        <script>
            (function () {
                var CHANNEL_ID = 'UCkAaHiYmUKIdKePifg1D2pg';
                var topPlayer = document.getElementById('livePraiseTopPlayer');
                var topWatchLink = document.getElementById('livePraiseWatchLink');
                var grid = document.getElementById('recentVideosGrid');
                var statusEl = document.getElementById('youtubeFeedStatus');

                if (!topPlayer || !grid) return;

                function embedUrl(videoId) {
                    return 'https://www.youtube.com/embed/' + encodeURIComponent(videoId) + '?rel=0';
                }

                function liveUrl() {
                    return 'https://www.youtube.com/embed/live_stream?channel=' + encodeURIComponent(CHANNEL_ID) + '&rel=0';
                }

                function renderRecent(videos, topVideoId) {
                    if (!Array.isArray(videos) || videos.length === 0) return;

                    var filtered = videos.filter(function (v) {
                        return v && v.id && v.id !== topVideoId;
                    });

                    var take = filtered.slice(0, 12);
                    if (take.length === 0) return;

                    grid.innerHTML = '';
                    take.forEach(function (v, idx) {
                        var card = document.createElement('div');
                        card.className = 'youtube-card';

                        var embed = document.createElement('div');
                        embed.className = 'youtube-embed';

                        var iframe = document.createElement('iframe');
                        iframe.loading = 'lazy';
                        iframe.referrerPolicy = 'strict-origin-when-cross-origin';
                        iframe.allow = 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share';
                        iframe.allowFullscreen = true;
                        iframe.title = (v.title || ('Recent video ' + (idx + 1)));
                        iframe.src = embedUrl(v.id);

                        embed.appendChild(iframe);
                        card.appendChild(embed);

                        var link = document.createElement('a');
                        link.className = 'youtube-card__link';
                        link.href = 'https://www.youtube.com/watch?v=' + encodeURIComponent(v.id);
                        link.target = '_blank';
                        link.rel = 'noopener noreferrer';
                        link.textContent = 'Watch on YouTube';
                        card.appendChild(link);

                        grid.appendChild(card);
                    });
                }

                function setTop(videoId) {
                    if (!videoId) return;
                    topPlayer.src = embedUrl(videoId);
                    if (topWatchLink) {
                        topWatchLink.href = 'https://www.youtube.com/watch?v=' + encodeURIComponent(videoId);
                    }
                }

                // Default behavior:
                // - If you are LIVE right now, show the live video.
                // - Otherwise, show the most recent upload.
                // - Always show a most-to-least-recent list below.
                fetch('/public/youtube.json', { cache: 'no-store' })
                    .then(function (r) { return r.ok ? r.json() : null; })
                    .then(function (data) {
                        if (!data || !data.ok) return;

                        var topVideoId = '';
                        if (data.live && data.live.isLive && data.live.videoId) {
                            topVideoId = data.live.videoId;
                            setTop(topVideoId);
                        } else if (Array.isArray(data.videos) && data.videos[0] && data.videos[0].id) {
                            topVideoId = data.videos[0].id;
                            setTop(topVideoId);
                        } else {
                            // Fall back to the live-by-channel embed if we couldn't determine anything.
                            topPlayer.src = liveUrl();
                        }

                        renderRecent(data.videos, topVideoId);

                        if (statusEl) {
                            statusEl.textContent = 'Updated: ' + (data.fetchedAt || 'just now');
                        }
                    })
                    .catch(function () {
                        if (statusEl) {
                            statusEl.textContent = 'Could not load the latest list. Showing the built-in videos below.';
                        }
                        // Keep the existing hardcoded embeds as a safe fallback.
                    });
            })();
        </script>
</body>
</html>
